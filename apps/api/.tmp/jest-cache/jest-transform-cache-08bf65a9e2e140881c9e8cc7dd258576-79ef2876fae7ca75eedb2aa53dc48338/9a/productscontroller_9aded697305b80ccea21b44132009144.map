{"file":"/Users/mannysarinana/Downloads/social-business-os-scaffold-v0.2/apps/api/src/modules/products/products.controller.ts","mappings":";;;;;;;;;;;;;;;AAAA,2CAUwB;AACxB,2CAA4D;AAC5D,qDAAyF;AACzF,yDAAqD;AAErD,MAAM,SAAS;CA8Bd;AA3BC;IAFC,IAAA,4BAAU,GAAE;IACZ,IAAA,0BAAQ,GAAE;;sCACE;AAIb;IAFC,IAAA,0BAAQ,GAAE;IACV,IAAA,2BAAS,EAAC,CAAC,CAAC;;wCACE;AAIf;IAFC,IAAA,4BAAU,GAAE;IACZ,IAAA,0BAAQ,GAAE;;8CACiB;AAI5B;IAFC,IAAA,0BAAQ,GAAE;IACV,IAAA,wBAAM,EAAC,oBAAW,CAAC;;uCACQ;AAI5B;IAFC,IAAA,0BAAQ,GAAE;IACV,IAAA,wBAAM,EAAC,sBAAa,CAAC;;yCACU;AAKhC;IAFC,IAAA,0BAAQ,GAAE;IACV,IAAA,4BAAU,GAAE;;wCACE;AAKf;IAHC,IAAA,4BAAU,GAAE;IACZ,IAAA,0BAAQ,GAAE;IACV,IAAA,qBAAG,EAAC,CAAC,CAAC;;8CACc;AAIhB,IAAM,kBAAkB,GAAxB,MAAM,kBAAkB;IAC7B,YAA6B,QAAyB;QAAzB,aAAQ,GAAR,QAAQ,CAAiB;IAAG,CAAC;IAGpD,AAAN,KAAK,CAAC,IAAI,CACU,SAA6B,EAChC,KAAc,EACb,MAAe;QAE/B,MAAM,GAAG,GAAG,CAAC,SAAS,IAAI,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC;QACzC,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,QAAQ,CAAC,KAAK,IAAI,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;QAC1D,MAAM,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,QAAQ,CAAC,MAAM,IAAI,IAAI,EAAE,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAC7E,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;IAC9C,CAAC;IAGK,AAAN,KAAK,CAAC,GAAG,CACW,SAA6B,EAClC,EAAU;QAEvB,MAAM,GAAG,GAAG,CAAC,SAAS,IAAI,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC;QACzC,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;IACpC,CAAC;IAGK,AAAN,KAAK,CAAC,MAAM,CACQ,SAA6B,EACvC,GAAc;QAEtB,MAAM,GAAG,GAAG,CAAC,SAAS,IAAI,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC;QACzC,MAAM,KAAK,GAAG,GAAG,CAAC,KAAK,IAAI,CAAC,GAAG,CAAC,WAAW,KAAK,SAAS,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;QAC3F,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,EAAE;YAC/B,GAAG,EAAE,GAAG,CAAC,GAAG;YACZ,KAAK,EAAE,GAAG,CAAC,KAAK;YAChB,WAAW,EAAE,GAAG,CAAC,WAAW,IAAI,IAAI;YACpC,IAAI,EAAE,OAAO,GAAG,CAAC,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC;YAChE,MAAM,EAAE,OAAO,GAAG,CAAC,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC;YACxE,KAAK;SACN,CAAC,CAAC;IACL,CAAC;IAGK,AAAN,KAAK,CAAC,MAAM,CACQ,SAA6B,EAClC,EAAU,EACf,GAAuB;QAE/B,MAAM,GAAG,GAAG,CAAC,SAAS,IAAI,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC;QACzC,MAAM,KAAK,GACT,GAAG,CAAC,KAAK;YACT,CAAC,GAAG,CAAC,WAAW,KAAK,SAAS,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;QAExE,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,EAAE,EAAE,EAAE;YACnC,GAAG,EAAE,GAAG,CAAC,GAAG;YACZ,KAAK,EAAE,GAAG,CAAC,KAAK;YAChB,WAAW,EAAE,GAAG,CAAC,WAAW,IAAI,IAAI;YACpC,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,GAAG,CAAC,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS;YACzF,MAAM,EAAE,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,OAAO,GAAG,CAAC,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS;YACnG,KAAK;SACN,CAAC,CAAC;IACL,CAAC;IAGK,AAAN,KAAK,CAAC,MAAM,CACQ,SAA6B,EAClC,EAAU;QAEvB,MAAM,GAAG,GAAG,CAAC,SAAS,IAAI,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC;QACzC,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;IACvC,CAAC;IAGK,AAAN,KAAK,CAAC,eAAe,CACD,SAA6B,EAClC,EAAU,EACR,KAAa;QAE5B,MAAM,GAAG,GAAG,CAAC,SAAS,IAAI,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC;QACzC,OAAO,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,GAAG,EAAE,EAAE,EAAE,MAAM,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC;IACpE,CAAC;IAGK,AAAN,KAAK,CAAC,aAAa,CACC,SAA6B,EAClC,EAAU;QAEvB,MAAM,GAAG,GAAG,CAAC,SAAS,IAAI,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC;QACzC,OAAO,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;IAC9C,CAAC;CACF,CAAA;AAzFY,gDAAkB;AAIvB;IADL,IAAA,YAAG,GAAE;IAEH,WAAA,IAAA,gBAAO,EAAC,OAAO,CAAC,CAAA;IAChB,WAAA,IAAA,cAAK,EAAC,MAAM,CAAC,CAAA;IACb,WAAA,IAAA,cAAK,EAAC,OAAO,CAAC,CAAA;;;;8CAMhB;AAGK;IADL,IAAA,YAAG,EAAC,KAAK,CAAC;IAER,WAAA,IAAA,gBAAO,EAAC,OAAO,CAAC,CAAA;IAChB,WAAA,IAAA,cAAK,EAAC,IAAI,CAAC,CAAA;;;;6CAIb;AAGK;IADL,IAAA,aAAI,GAAE;IAEJ,WAAA,IAAA,gBAAO,EAAC,OAAO,CAAC,CAAA;IAChB,WAAA,IAAA,aAAI,GAAE,CAAA;;6CAAM,SAAS;;gDAYvB;AAGK;IADL,IAAA,YAAG,EAAC,KAAK,CAAC;IAER,WAAA,IAAA,gBAAO,EAAC,OAAO,CAAC,CAAA;IAChB,WAAA,IAAA,cAAK,EAAC,IAAI,CAAC,CAAA;IACX,WAAA,IAAA,aAAI,GAAE,CAAA;;;;gDAeR;AAGK;IADL,IAAA,eAAM,EAAC,KAAK,CAAC;IAEX,WAAA,IAAA,gBAAO,EAAC,OAAO,CAAC,CAAA;IAChB,WAAA,IAAA,cAAK,EAAC,IAAI,CAAC,CAAA;;;;gDAIb;AAGK;IADL,IAAA,aAAI,EAAC,eAAe,CAAC;IAEnB,WAAA,IAAA,gBAAO,EAAC,OAAO,CAAC,CAAA;IAChB,WAAA,IAAA,cAAK,EAAC,IAAI,CAAC,CAAA;IACX,WAAA,IAAA,aAAI,EAAC,OAAO,CAAC,CAAA;;;;yDAIf;AAGK;IADL,IAAA,YAAG,EAAC,eAAe,CAAC;IAElB,WAAA,IAAA,gBAAO,EAAC,OAAO,CAAC,CAAA;IAChB,WAAA,IAAA,cAAK,EAAC,IAAI,CAAC,CAAA;;;;uDAIb;6BAxFU,kBAAkB;IAD9B,IAAA,mBAAU,EAAC,UAAU,CAAC;qCAEkB,kCAAe;GAD3C,kBAAkB,CAyF9B","names":[],"sources":["/Users/mannysarinana/Downloads/social-business-os-scaffold-v0.2/apps/api/src/modules/products/products.controller.ts"],"sourcesContent":["import {\n  Body,\n  Controller,\n  Delete,\n  Get,\n  Headers,\n  Param,\n  Post,\n  Put,\n  Query,\n} from '@nestjs/common';\nimport { ProductStatus, ProductType } from '@prisma/client';\nimport { IsEnum, IsNumber, IsOptional, IsString, Min, MinLength } from 'class-validator';\nimport { ProductsService } from './products.service';\n\nclass CreateDto {\n  @IsOptional()\n  @IsString()\n  sku?: string;\n\n  @IsString()\n  @MinLength(1)\n  title!: string;\n\n  @IsOptional()\n  @IsString()\n  description?: string | null;\n\n  @IsString()\n  @IsEnum(ProductType)\n  type!: ProductType | string;\n\n  @IsString()\n  @IsEnum(ProductStatus)\n  status!: ProductStatus | string;\n\n  // Accept number or string at the edge; coerce to string for the service\n  @IsString()\n  @IsOptional()\n  price?: string;\n\n  @IsOptional()\n  @IsNumber()\n  @Min(0)\n  priceNumber?: number;\n}\n\n@Controller('products')\nexport class ProductsController {\n  constructor(private readonly products: ProductsService) {}\n\n  @Get()\n  async list(\n    @Headers('x-org') orgHeader: string | undefined,\n    @Query('page') pageQ?: string,\n    @Query('limit') limitQ?: string,\n  ) {\n    const org = (orgHeader ?? 'demo').trim();\n    const page = Math.max(1, parseInt(pageQ ?? '1', 10) || 1);\n    const limit = Math.max(1, Math.min(100, parseInt(limitQ ?? '10', 10) || 10));\n    return this.products.list(org, page, limit);\n  }\n\n  @Get(':id')\n  async get(\n    @Headers('x-org') orgHeader: string | undefined,\n    @Param('id') id: string,\n  ) {\n    const org = (orgHeader ?? 'demo').trim();\n    return this.products.get(org, id);\n  }\n\n  @Post()\n  async create(\n    @Headers('x-org') orgHeader: string | undefined,\n    @Body() dto: CreateDto,\n  ) {\n    const org = (orgHeader ?? 'demo').trim();\n    const price = dto.price ?? (dto.priceNumber !== undefined ? String(dto.priceNumber) : '0');\n    return this.products.create(org, {\n      sku: dto.sku,\n      title: dto.title,\n      description: dto.description ?? null,\n      type: typeof dto.type === 'string' ? dto.type : String(dto.type),\n      status: typeof dto.status === 'string' ? dto.status : String(dto.status),\n      price,\n    });\n  }\n\n  @Put(':id')\n  async update(\n    @Headers('x-org') orgHeader: string | undefined,\n    @Param('id') id: string,\n    @Body() dto: Partial<CreateDto>,\n  ) {\n    const org = (orgHeader ?? 'demo').trim();\n    const price =\n      dto.price ??\n      (dto.priceNumber !== undefined ? String(dto.priceNumber) : undefined);\n\n    return this.products.update(org, id, {\n      sku: dto.sku,\n      title: dto.title,\n      description: dto.description ?? null,\n      type: dto.type ? (typeof dto.type === 'string' ? dto.type : String(dto.type)) : undefined,\n      status: dto.status ? (typeof dto.status === 'string' ? dto.status : String(dto.status)) : undefined,\n      price,\n    });\n  }\n\n  @Delete(':id')\n  async remove(\n    @Headers('x-org') orgHeader: string | undefined,\n    @Param('id') id: string,\n  ) {\n    const org = (orgHeader ?? 'demo').trim();\n    return this.products.remove(org, id);\n  }\n\n  @Post(':id/inventory')\n  async adjustInventory(\n    @Headers('x-org') orgHeader: string | undefined,\n    @Param('id') id: string,\n    @Body('delta') delta: number,\n  ) {\n    const org = (orgHeader ?? 'demo').trim();\n    return this.products.adjustInventory(org, id, Number(delta || 0));\n  }\n\n  @Get(':id/inventory')\n  async readInventory(\n    @Headers('x-org') orgHeader: string | undefined,\n    @Param('id') id: string,\n  ) {\n    const org = (orgHeader ?? 'demo').trim();\n    return this.products.readInventory(org, id);\n  }\n}"],"version":3}