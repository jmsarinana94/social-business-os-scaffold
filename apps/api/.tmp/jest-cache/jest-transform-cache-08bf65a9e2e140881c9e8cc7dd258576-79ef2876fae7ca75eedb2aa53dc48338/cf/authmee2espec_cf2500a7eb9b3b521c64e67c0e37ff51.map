{"file":"/Users/mannysarinana/Downloads/social-business-os-scaffold-v0.2/apps/api/test/e2e/auth.me.e2e-spec.ts","mappings":";;;;;AAAA,2CAAkE;AAClE,6CAAuC;AACvC,0DAAgC;AAChC,qDAAiD;AAEjD,QAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE;IACnC,IAAI,GAAqB,CAAC;IAC1B,MAAM,WAAW,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,kBAAkB,EAAE,CAAC;IAC5E,MAAM,KAAK,GAAG,OAAO,CAAC,GAAG,CAAC,SAAS,IAAI,oBAAoB,CAAC;IAC5D,MAAM,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC,QAAQ,IAAI,aAAa,CAAC;IAEvD,SAAS,CAAC,KAAK,IAAI,EAAE;QACnB,MAAM,SAAS,GAAG,MAAM,cAAI,CAAC,mBAAmB,CAAC;YAC/C,OAAO,EAAE,CAAC,sBAAS,CAAC;SACrB,CAAC,CAAC,OAAO,EAAE,CAAC;QAEb,GAAG,GAAG,SAAS,CAAC,qBAAqB,EAAE,CAAC;QACxC,GAAG,CAAC,cAAc,CAAC,IAAI,uBAAc,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;QAC7E,MAAM,GAAG,CAAC,IAAI,EAAE,CAAC;IACnB,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,KAAK,IAAI,EAAE;QAClB,MAAM,GAAG,CAAC,KAAK,EAAE,CAAC;IACpB,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;QACxD,MAAM,KAAK,GAAG,MAAM,IAAA,mBAAO,EAAC,GAAG,CAAC,aAAa,EAAE,CAAC;aAC7C,IAAI,CAAC,aAAa,CAAC;aACnB,GAAG,CAAC,WAAW,CAAC;aAChB,IAAI,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC;aACzB,MAAM,CAAC,GAAG,CAAC,CAAC;QAEf,MAAM,KAAK,GACT,KAAK,CAAC,IAAI,EAAE,YAAY,IAAI,KAAK,CAAC,IAAI,EAAE,KAAK,IAAI,eAAe,CAAC;QAEnE,MAAM,EAAE,GAAG,MAAM,IAAA,mBAAO,EAAC,GAAG,CAAC,aAAa,EAAE,CAAC;aAC1C,GAAG,CAAC,UAAU,CAAC;aACf,GAAG,CAAC,EAAE,GAAG,WAAW,EAAE,aAAa,EAAE,UAAU,KAAK,EAAE,EAAE,CAAC;aACzD,MAAM,CAAC,GAAG,CAAC,CAAC;QAEf,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;QACrC,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,cAAc,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;IACjD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,yBAAyB,EAAE,KAAK,IAAI,EAAE;QACvC,MAAM,IAAA,mBAAO,EAAC,GAAG,CAAC,aAAa,EAAE,CAAC;aAC/B,GAAG,CAAC,UAAU,CAAC;aACf,GAAG,CAAC,WAAW,CAAC;aAChB,MAAM,CAAC,GAAG,CAAC,CAAC;IACjB,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["/Users/mannysarinana/Downloads/social-business-os-scaffold-v0.2/apps/api/test/e2e/auth.me.e2e-spec.ts"],"sourcesContent":["import { INestApplication, ValidationPipe } from '@nestjs/common';\nimport { Test } from '@nestjs/testing';\nimport request from 'supertest';\nimport { AppModule } from '../../src/app.module';\n\ndescribe('Auth /auth/me (e2e)', () => {\n  let app: INestApplication;\n  const baseHeaders = { 'x-org': 'demo', 'content-type': 'application/json' };\n  const email = process.env.API_EMAIL || 'tester@example.com';\n  const password = process.env.API_PASS || 'password123';\n\n  beforeAll(async () => {\n    const moduleRef = await Test.createTestingModule({\n      imports: [AppModule],\n    }).compile();\n\n    app = moduleRef.createNestApplication();\n    app.useGlobalPipes(new ValidationPipe({ whitelist: true, transform: true }));\n    await app.init();\n  });\n\n  afterAll(async () => {\n    await app.close();\n  });\n\n  it('returns the current user when authorized', async () => {\n    const login = await request(app.getHttpServer())\n      .post('/auth/login')\n      .set(baseHeaders)\n      .send({ email, password })\n      .expect(200);\n\n    const token =\n      login.body?.access_token || login.body?.token || 'invalid-token';\n\n    const me = await request(app.getHttpServer())\n      .get('/auth/me')\n      .set({ ...baseHeaders, Authorization: `Bearer ${token}` })\n      .expect(200);\n\n    expect(me.body).toHaveProperty('id');\n    expect(me.body).toHaveProperty('email', email);\n  });\n\n  it('rejects without a token', async () => {\n    await request(app.getHttpServer())\n      .get('/auth/me')\n      .set(baseHeaders)\n      .expect(401);\n  });\n});"],"version":3}