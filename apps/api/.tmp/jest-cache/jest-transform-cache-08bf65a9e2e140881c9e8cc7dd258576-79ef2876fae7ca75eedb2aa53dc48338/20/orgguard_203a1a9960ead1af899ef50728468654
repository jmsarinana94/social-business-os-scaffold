79e5e1011206a1d1c38c866a38c19a53
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.OrgHeaderGuard = void 0;
const common_1 = require("@nestjs/common");
let OrgHeaderGuard = class OrgHeaderGuard {
    canActivate(context) {
        const req = context.switchToHttp().getRequest();
        const slug = req.header('x-org')?.trim();
        if (!slug) {
            throw new common_1.BadRequestException('x-org header required');
        }
        // stow for handlers that want it without re-reading headers
        req.__orgSlug = slug;
        return true;
    }
};
exports.OrgHeaderGuard = OrgHeaderGuard;
exports.OrgHeaderGuard = OrgHeaderGuard = __decorate([
    (0, common_1.Injectable)()
], OrgHeaderGuard);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21hbm55c2FyaW5hbmEvRG93bmxvYWRzL3NvY2lhbC1idXNpbmVzcy1vcy1zY2FmZm9sZC12MC4yL2FwcHMvYXBpL3NyYy9jb21tb24vZ3VhcmRzL29yZy5ndWFyZC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSwyQ0FBZ0c7QUFJekYsSUFBTSxjQUFjLEdBQXBCLE1BQU0sY0FBYztJQUN6QixXQUFXLENBQUMsT0FBeUI7UUFDbkMsTUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLFlBQVksRUFBRSxDQUFDLFVBQVUsRUFBVyxDQUFDO1FBQ3pELE1BQU0sSUFBSSxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUM7UUFDekMsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ1YsTUFBTSxJQUFJLDRCQUFtQixDQUFDLHVCQUF1QixDQUFDLENBQUM7UUFDekQsQ0FBQztRQUNELDREQUE0RDtRQUMzRCxHQUFXLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztRQUM5QixPQUFPLElBQUksQ0FBQztJQUNaLENBQUM7Q0FDSixDQUFBO0FBWFksd0NBQWM7eUJBQWQsY0FBYztJQUQxQixJQUFBLG1CQUFVLEdBQUU7R0FDQSxjQUFjLENBVzFCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYW5ueXNhcmluYW5hL0Rvd25sb2Fkcy9zb2NpYWwtYnVzaW5lc3Mtb3Mtc2NhZmZvbGQtdjAuMi9hcHBzL2FwaS9zcmMvY29tbW9uL2d1YXJkcy9vcmcuZ3VhcmQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQmFkUmVxdWVzdEV4Y2VwdGlvbiwgQ2FuQWN0aXZhdGUsIEV4ZWN1dGlvbkNvbnRleHQsIEluamVjdGFibGUgfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBSZXF1ZXN0IH0gZnJvbSAnZXhwcmVzcyc7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBPcmdIZWFkZXJHdWFyZCBpbXBsZW1lbnRzIENhbkFjdGl2YXRlIHtcbiAgY2FuQWN0aXZhdGUoY29udGV4dDogRXhlY3V0aW9uQ29udGV4dCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHJlcSA9IGNvbnRleHQuc3dpdGNoVG9IdHRwKCkuZ2V0UmVxdWVzdDxSZXF1ZXN0PigpO1xuICAgIGNvbnN0IHNsdWcgPSByZXEuaGVhZGVyKCd4LW9yZycpPy50cmltKCk7XG4gICAgaWYgKCFzbHVnKSB7XG4gICAgICB0aHJvdyBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbigneC1vcmcgaGVhZGVyIHJlcXVpcmVkJyk7XG4gICAgfVxuICAgIC8vIHN0b3cgZm9yIGhhbmRsZXJzIHRoYXQgd2FudCBpdCB3aXRob3V0IHJlLXJlYWRpbmcgaGVhZGVyc1xuICAgIChyZXEgYXMgYW55KS5fX29yZ1NsdWcgPSBzbHVnO1xuICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn0iXSwidmVyc2lvbiI6M30=