4a215032a93b8c63c3fdca32a76dc181
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.ProductsController = void 0;
const common_1 = require("@nestjs/common");
const products_service_1 = require("./products.service");
let ProductsController = class ProductsController {
    constructor(products) {
        this.products = products;
    }
    async list(org, page = '1', limit = '10') {
        const p = Number.parseInt(page, 10) || 1;
        const l = Number.parseInt(limit, 10) || 10;
        return this.products.list(org, p, l);
    }
    async get(org, id) {
        return this.products.get(org, id);
    }
    async create(org, body) {
        // Let the service normalize enums; no string re-casting here
        return this.products.create(org, body);
    }
    async update(org, id, body) {
        // Pass through; service validates & normalizes
        return this.products.update(org, id, body);
    }
    async remove(org, id) {
        return this.products.remove(org, id);
    }
    async getInventory(org, id) {
        return this.products.getInventory(org, id);
    }
    async adjustInventory(org, id, body) {
        const delta = Number(body?.delta ?? 0);
        return this.products.adjustInventory(org, id, delta);
    }
};
exports.ProductsController = ProductsController;
__decorate([
    (0, common_1.Get)(),
    __param(0, (0, common_1.Headers)('x-org')),
    __param(1, (0, common_1.Query)('page')),
    __param(2, (0, common_1.Query)('limit')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Object, Object]),
    __metadata("design:returntype", Promise)
], ProductsController.prototype, "list", null);
__decorate([
    (0, common_1.Get)(':id'),
    __param(0, (0, common_1.Headers)('x-org')),
    __param(1, (0, common_1.Param)('id')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String]),
    __metadata("design:returntype", Promise)
], ProductsController.prototype, "get", null);
__decorate([
    (0, common_1.Post)(),
    __param(0, (0, common_1.Headers)('x-org')),
    __param(1, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Object]),
    __metadata("design:returntype", Promise)
], ProductsController.prototype, "create", null);
__decorate([
    (0, common_1.Put)(':id'),
    __param(0, (0, common_1.Headers)('x-org')),
    __param(1, (0, common_1.Param)('id')),
    __param(2, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, Object]),
    __metadata("design:returntype", Promise)
], ProductsController.prototype, "update", null);
__decorate([
    (0, common_1.Delete)(':id'),
    __param(0, (0, common_1.Headers)('x-org')),
    __param(1, (0, common_1.Param)('id')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String]),
    __metadata("design:returntype", Promise)
], ProductsController.prototype, "remove", null);
__decorate([
    (0, common_1.Get)(':id/inventory'),
    __param(0, (0, common_1.Headers)('x-org')),
    __param(1, (0, common_1.Param)('id')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String]),
    __metadata("design:returntype", Promise)
], ProductsController.prototype, "getInventory", null);
__decorate([
    (0, common_1.Post)(':id/inventory'),
    __param(0, (0, common_1.Headers)('x-org')),
    __param(1, (0, common_1.Param)('id')),
    __param(2, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, Object]),
    __metadata("design:returntype", Promise)
], ProductsController.prototype, "adjustInventory", null);
exports.ProductsController = ProductsController = __decorate([
    (0, common_1.Controller)('products'),
    __metadata("design:paramtypes", [products_service_1.ProductsService])
], ProductsController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21hbm55c2FyaW5hbmEvRG93bmxvYWRzL3NvY2lhbC1idXNpbmVzcy1vcy1zY2FmZm9sZC12MC4yL2FwcHMvYXBpL3NyYy9tb2R1bGVzL3Byb2R1Y3RzL3Byb2R1Y3RzLmNvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkNBVXdCO0FBQ3hCLHlEQUFxRDtBQWU5QyxJQUFNLGtCQUFrQixHQUF4QixNQUFNLGtCQUFrQjtJQUM3QixZQUE2QixRQUF5QjtRQUF6QixhQUFRLEdBQVIsUUFBUSxDQUFpQjtJQUFHLENBQUM7SUFHcEQsQUFBTixLQUFLLENBQUMsSUFBSSxDQUNVLEdBQVcsRUFDZCxPQUFPLEdBQUcsRUFDVCxRQUFRLElBQUk7UUFFNUIsTUFBTSxDQUFDLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFjLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ25ELE1BQU0sQ0FBQyxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBZSxFQUFFLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNyRCxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQUdLLEFBQU4sS0FBSyxDQUFDLEdBQUcsQ0FDVyxHQUFXLEVBQ2hCLEVBQVU7UUFFdkIsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDcEMsQ0FBQztJQUdLLEFBQU4sS0FBSyxDQUFDLE1BQU0sQ0FDUSxHQUFXLEVBQ3JCLElBQWdCO1FBRXhCLDZEQUE2RDtRQUM3RCxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBR0ssQUFBTixLQUFLLENBQUMsTUFBTSxDQUNRLEdBQVcsRUFDaEIsRUFBVSxFQUNmLElBQWdCO1FBRXhCLCtDQUErQztRQUMvQyxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUdLLEFBQU4sS0FBSyxDQUFDLE1BQU0sQ0FDUSxHQUFXLEVBQ2hCLEVBQVU7UUFFdkIsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQUdLLEFBQU4sS0FBSyxDQUFDLFlBQVksQ0FDRSxHQUFXLEVBQ2hCLEVBQVU7UUFFdkIsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUdLLEFBQU4sS0FBSyxDQUFDLGVBQWUsQ0FDRCxHQUFXLEVBQ2hCLEVBQVUsRUFDZixJQUFnQjtRQUV4QixNQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsSUFBSSxFQUFFLEtBQUssSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN2QyxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDdkQsQ0FBQztDQUNGLENBQUE7QUFsRVksZ0RBQWtCO0FBSXZCO0lBREwsSUFBQSxZQUFHLEdBQUU7SUFFSCxXQUFBLElBQUEsZ0JBQU8sRUFBQyxPQUFPLENBQUMsQ0FBQTtJQUNoQixXQUFBLElBQUEsY0FBSyxFQUFDLE1BQU0sQ0FBQyxDQUFBO0lBQ2IsV0FBQSxJQUFBLGNBQUssRUFBQyxPQUFPLENBQUMsQ0FBQTs7Ozs4Q0FLaEI7QUFHSztJQURMLElBQUEsWUFBRyxFQUFDLEtBQUssQ0FBQztJQUVSLFdBQUEsSUFBQSxnQkFBTyxFQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ2hCLFdBQUEsSUFBQSxjQUFLLEVBQUMsSUFBSSxDQUFDLENBQUE7Ozs7NkNBR2I7QUFHSztJQURMLElBQUEsYUFBSSxHQUFFO0lBRUosV0FBQSxJQUFBLGdCQUFPLEVBQUMsT0FBTyxDQUFDLENBQUE7SUFDaEIsV0FBQSxJQUFBLGFBQUksR0FBRSxDQUFBOzs7O2dEQUlSO0FBR0s7SUFETCxJQUFBLFlBQUcsRUFBQyxLQUFLLENBQUM7SUFFUixXQUFBLElBQUEsZ0JBQU8sRUFBQyxPQUFPLENBQUMsQ0FBQTtJQUNoQixXQUFBLElBQUEsY0FBSyxFQUFDLElBQUksQ0FBQyxDQUFBO0lBQ1gsV0FBQSxJQUFBLGFBQUksR0FBRSxDQUFBOzs7O2dEQUlSO0FBR0s7SUFETCxJQUFBLGVBQU0sRUFBQyxLQUFLLENBQUM7SUFFWCxXQUFBLElBQUEsZ0JBQU8sRUFBQyxPQUFPLENBQUMsQ0FBQTtJQUNoQixXQUFBLElBQUEsY0FBSyxFQUFDLElBQUksQ0FBQyxDQUFBOzs7O2dEQUdiO0FBR0s7SUFETCxJQUFBLFlBQUcsRUFBQyxlQUFlLENBQUM7SUFFbEIsV0FBQSxJQUFBLGdCQUFPLEVBQUMsT0FBTyxDQUFDLENBQUE7SUFDaEIsV0FBQSxJQUFBLGNBQUssRUFBQyxJQUFJLENBQUMsQ0FBQTs7OztzREFHYjtBQUdLO0lBREwsSUFBQSxhQUFJLEVBQUMsZUFBZSxDQUFDO0lBRW5CLFdBQUEsSUFBQSxnQkFBTyxFQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ2hCLFdBQUEsSUFBQSxjQUFLLEVBQUMsSUFBSSxDQUFDLENBQUE7SUFDWCxXQUFBLElBQUEsYUFBSSxHQUFFLENBQUE7Ozs7eURBSVI7NkJBakVVLGtCQUFrQjtJQUQ5QixJQUFBLG1CQUFVLEVBQUMsVUFBVSxDQUFDO3FDQUVrQixrQ0FBZTtHQUQzQyxrQkFBa0IsQ0FrRTlCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYW5ueXNhcmluYW5hL0Rvd25sb2Fkcy9zb2NpYWwtYnVzaW5lc3Mtb3Mtc2NhZmZvbGQtdjAuMi9hcHBzL2FwaS9zcmMvbW9kdWxlcy9wcm9kdWN0cy9wcm9kdWN0cy5jb250cm9sbGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEJvZHksXG4gIENvbnRyb2xsZXIsXG4gIERlbGV0ZSxcbiAgR2V0LFxuICBIZWFkZXJzLFxuICBQYXJhbSxcbiAgUG9zdCxcbiAgUHV0LFxuICBRdWVyeSxcbn0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgUHJvZHVjdHNTZXJ2aWNlIH0gZnJvbSAnLi9wcm9kdWN0cy5zZXJ2aWNlJztcblxudHlwZSBDcmVhdGVCb2R5ID0ge1xuICBza3U/OiBzdHJpbmc7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nIHwgbnVsbDtcbiAgdHlwZTogJ1BIWVNJQ0FMJyB8ICdESUdJVEFMJztcbiAgc3RhdHVzOiAnQUNUSVZFJyB8ICdJTkFDVElWRSc7XG4gIHByaWNlOiBzdHJpbmc7XG59O1xuXG50eXBlIFVwZGF0ZUJvZHkgPSBQYXJ0aWFsPENyZWF0ZUJvZHk+O1xudHlwZSBBZGp1c3RCb2R5ID0geyBkZWx0YTogbnVtYmVyIH07XG5cbkBDb250cm9sbGVyKCdwcm9kdWN0cycpXG5leHBvcnQgY2xhc3MgUHJvZHVjdHNDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBwcm9kdWN0czogUHJvZHVjdHNTZXJ2aWNlKSB7fVxuXG4gIEBHZXQoKVxuICBhc3luYyBsaXN0KFxuICAgIEBIZWFkZXJzKCd4LW9yZycpIG9yZzogc3RyaW5nLFxuICAgIEBRdWVyeSgncGFnZScpIHBhZ2UgPSAnMScsXG4gICAgQFF1ZXJ5KCdsaW1pdCcpIGxpbWl0ID0gJzEwJyxcbiAgKSB7XG4gICAgY29uc3QgcCA9IE51bWJlci5wYXJzZUludChwYWdlIGFzIHN0cmluZywgMTApIHx8IDE7XG4gICAgY29uc3QgbCA9IE51bWJlci5wYXJzZUludChsaW1pdCBhcyBzdHJpbmcsIDEwKSB8fCAxMDtcbiAgICByZXR1cm4gdGhpcy5wcm9kdWN0cy5saXN0KG9yZywgcCwgbCk7XG4gIH1cblxuICBAR2V0KCc6aWQnKVxuICBhc3luYyBnZXQoXG4gICAgQEhlYWRlcnMoJ3gtb3JnJykgb3JnOiBzdHJpbmcsXG4gICAgQFBhcmFtKCdpZCcpIGlkOiBzdHJpbmcsXG4gICkge1xuICAgIHJldHVybiB0aGlzLnByb2R1Y3RzLmdldChvcmcsIGlkKTtcbiAgfVxuXG4gIEBQb3N0KClcbiAgYXN5bmMgY3JlYXRlKFxuICAgIEBIZWFkZXJzKCd4LW9yZycpIG9yZzogc3RyaW5nLFxuICAgIEBCb2R5KCkgYm9keTogQ3JlYXRlQm9keSxcbiAgKSB7XG4gICAgLy8gTGV0IHRoZSBzZXJ2aWNlIG5vcm1hbGl6ZSBlbnVtczsgbm8gc3RyaW5nIHJlLWNhc3RpbmcgaGVyZVxuICAgIHJldHVybiB0aGlzLnByb2R1Y3RzLmNyZWF0ZShvcmcsIGJvZHkpO1xuICB9XG5cbiAgQFB1dCgnOmlkJylcbiAgYXN5bmMgdXBkYXRlKFxuICAgIEBIZWFkZXJzKCd4LW9yZycpIG9yZzogc3RyaW5nLFxuICAgIEBQYXJhbSgnaWQnKSBpZDogc3RyaW5nLFxuICAgIEBCb2R5KCkgYm9keTogVXBkYXRlQm9keSxcbiAgKSB7XG4gICAgLy8gUGFzcyB0aHJvdWdoOyBzZXJ2aWNlIHZhbGlkYXRlcyAmIG5vcm1hbGl6ZXNcbiAgICByZXR1cm4gdGhpcy5wcm9kdWN0cy51cGRhdGUob3JnLCBpZCwgYm9keSk7XG4gIH1cblxuICBARGVsZXRlKCc6aWQnKVxuICBhc3luYyByZW1vdmUoXG4gICAgQEhlYWRlcnMoJ3gtb3JnJykgb3JnOiBzdHJpbmcsXG4gICAgQFBhcmFtKCdpZCcpIGlkOiBzdHJpbmcsXG4gICkge1xuICAgIHJldHVybiB0aGlzLnByb2R1Y3RzLnJlbW92ZShvcmcsIGlkKTtcbiAgfVxuXG4gIEBHZXQoJzppZC9pbnZlbnRvcnknKVxuICBhc3luYyBnZXRJbnZlbnRvcnkoXG4gICAgQEhlYWRlcnMoJ3gtb3JnJykgb3JnOiBzdHJpbmcsXG4gICAgQFBhcmFtKCdpZCcpIGlkOiBzdHJpbmcsXG4gICkge1xuICAgIHJldHVybiB0aGlzLnByb2R1Y3RzLmdldEludmVudG9yeShvcmcsIGlkKTtcbiAgfVxuXG4gIEBQb3N0KCc6aWQvaW52ZW50b3J5JylcbiAgYXN5bmMgYWRqdXN0SW52ZW50b3J5KFxuICAgIEBIZWFkZXJzKCd4LW9yZycpIG9yZzogc3RyaW5nLFxuICAgIEBQYXJhbSgnaWQnKSBpZDogc3RyaW5nLFxuICAgIEBCb2R5KCkgYm9keTogQWRqdXN0Qm9keSxcbiAgKSB7XG4gICAgY29uc3QgZGVsdGEgPSBOdW1iZXIoYm9keT8uZGVsdGEgPz8gMCk7XG4gICAgcmV0dXJuIHRoaXMucHJvZHVjdHMuYWRqdXN0SW52ZW50b3J5KG9yZywgaWQsIGRlbHRhKTtcbiAgfVxufSJdLCJ2ZXJzaW9uIjozfQ==